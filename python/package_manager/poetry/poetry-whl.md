# Как с помощью poetry создать и установить .whl пакеты

## Навигация

### 1. Создание .whl пакета

Poetry автоматически собирает <b>wheel-пакеты</b>, когда вы используете команду `poetry build`. Файлы
 создаются в папке <b>dist</b>.

- `poetry add some_package` — команда для добавления зависимости в проект.

- `poetry build` — команда, которая собирает ваш проект в <b>.whl</b> и <b>.tar.gz</b> файлы для 
распространения.

Когда вы запускаете poetry build, по умолчанию создаются оба файла:

- `.whl` — (wheel): это скомпилированный дистрибутив. Предпочтительный формат для 
установки через `pip`. Быстрее устанавливается, так как не требует компиляции. Подходит для проектов, 
которые не зависят от компиляции кода на стороне пользователя.

- `.tar.gz` — (source distribution): полный исходный код вашего проекта. Нужен, если wheel недоступен
для целевой платформы (например, если требуется специфическая компиляция под ОС
или архитектуру). Используется, если проект содержит C-расширения, которые должны быть скомпилированы.


### 2. Установка зависимостей .whl

Установка зависимостей из ```<b>dist</b>``` происходит с помощью <b>pip</b> - `pip install dist/*.whl`
___
### P.S. Дополнительная информация

#### Почему Poetry и Pip?
`Poetry` предназначен для разработки и управления зависимостями, а не для установки уже готовых пакетов.

`Pip` — это стандартный инструмент для установки пакетов Python, включая <b>.whl</b> и <b>.tar.gz.</b>
___
#### Когда будет создан только .tar.gz или только .whl?
- Только `.whl`: невозможно, так как Poetry всегда создает оба файла.
- Только `.tar.gz`: вы можете вручную удалить <b>.whl</b> из папки <b>dist</b>, но это не стандартная 
практика.
___

#### Как вкратце работает под капотом:
1. Когда вы выполняете `poetry build`, <b>Poetry</b> автоматически записывает зависимости в файл ,<b>METADATA</b>
 внутри <b>.whl.</b> Это происходит на основе секции <b>[tool.poetry.dependencies]</b> в <b>pyproject.toml</b>.

2. При установке пакета с помощью `pip install dist/my_project-0.1.0-py3-none-any.whl`:
- pip проверяет метаданные пакета (METADATA), включая список зависимостей.
- Устанавливает сам пакет и подтягивает все указанные зависимости.

<b>Poetry</b> собирает только те данные, которые необходимы для правильной работы пакета и его установки, включая метаданные, зависимости, скрипты и файлы. Если нужно включить дополнительные файлы в пакет, их нужно указать в секции <b>package</b> или с помощью <b>include/exclude</b>.
___
#### Секции pyproject.toml, которые не формируют .whl

1. `[tool.poetry.dev-dependencies]`

Эта секция содержит зависимости, которые необходимы только для разработки, например, инструменты для тестирования или линтинга.
Зависимости не включаются в сам .whl, хотя они будут указаны в метаданных и будут установлены, если использовать poetry install в среде разработки.

2. `[tool.poetry.scripts]`

Эта секция указывает на пользовательские скрипты, которые можно будет запускать из командной строки после установки пакета.
Хотя скрипты будут доступны после установки, они не включаются в сам .whl файл, а лишь указываются в метаданных пакета. Пакет создается без их явного присутствия в .whl.

3. `[tool.poetry.urls]`

Эта секция содержит различные URL, такие как ссылки на домашнюю страницу проекта или документацию.
Эти URL-адреса не включаются в сам .whl файл. Они будут просто указаны в метаданных.

4. `[tool.poetry.plugins]`

Эта секция используется для регистрации плагинов, которые проект может предоставлять.
Плагины будут указаны в метаданных .whl файла, но их код не будет включен в сам .whl пакет. Пакет содержит только ссылки на плагины.

5. `[tool.poetry.build]`

Эта секция определяет различные параметры для процесса сборки пакета.
Она используется для настройки поведения сборки (например, в CI/CD), но не влияет на сам .whl файл.

6. `[tool.poetry.package]` (если не указаны файлы для включения)

Эта секция может использоваться для включения дополнительных файлов в пакет, таких как ресурсы или C-расширения.
Если в секции не указаны файлы для включения, то она не влияет на содержимое .whl.

7. `[tool.poetry.include] / [tool.poetry.exclude]`

Эти секции могут использоваться для включения или исключения файлов из пакета.
Если они пусты или не настроены, то они не влияют на содержимое .whl.


